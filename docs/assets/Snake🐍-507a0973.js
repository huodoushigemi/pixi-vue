import{b}from"./index-62d7c471.js";import{u as G}from"./index-f886bb74.js";import{d as L,g as R,i as y,r as F,o as D,c as i,b as d,u as t,F as _,j as p,n as U,k as z,a as s}from"./index-c7670b82.js";const B=["drawRect"],C={zIndex:1},E=["drawRect","alpha"],I=d("Text",{text:"🐍 SNAKE",x:12,"style+":{fill:16777215,lineHeight:55}},null,-1),N=["x","lineTo"],H=["y","lineTo"],M=["x","y"],V=["x","y","drawRect"],$=["x","y"],j=["x","y"],J=L({__name:"Snake🐍",setup(K){const h=R().proxy.$app.screen.width,m=R().proxy.$app.screen.height-80,n=y(()=>Math.min(h,m)/10),a=y(()=>h/n.value>>0),u=y(()=>m/n.value>>0),c=F([[2,5],[1,5],[0,5]]),f=F(k());let o="ArrowRight",v=o;b(window,"keydown",e=>{if(e.key==" ")return A.value?w():T();["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&(o=="ArrowUp"&&e.key=="ArrowDown"||o=="ArrowDown"&&e.key=="ArrowUp"||o=="ArrowLeft"&&e.key=="ArrowRight"||o=="ArrowRight"&&e.key=="ArrowLeft"||(v=e.key))});const{resume:T,pause:w,isActive:A}=G(()=>{o=v;const e=c.value[0];let r;if(o=="ArrowUp"&&(r=[e[0],e[1]-1]),o=="ArrowDown"&&(r=[e[0],e[1]+1]),o=="ArrowLeft"&&(r=[e[0]-1,e[1]]),o=="ArrowRight"&&(r=[e[0]+1,e[1]]),!S(r))return w(),alert("撞墙身亡，游戏结束");if(c.value.slice(0,-1).some(l=>x(l,r)))return w(),alert("咬到自己，游戏结束");c.value.unshift(r),x(r,f.value)?f.value=k():c.value.pop()},250);D(()=>{w()});function x(e,r){return e[0]==r[0]&&e[1]==r[1]}function S(e){return e[0]>=0&&e[0]<a.value&&e[1]>=0&&e[1]<u.value}function g(e,r=0){return r+Math.random()*(e-r)>>0}function k(){let e;do e=[g(a.value),g(u.value)];while(c.value.some(r=>x(r,e)));return e}return(e,r)=>(s(),i("Graphics",{sortableChildren:!0,beginFill:[2368548],drawRect:[0,0,t(h),m],endFill:""},[d("Graphics",C,[d("Graphics",{beginFill:[2962235],drawRect:[0,0,t(h),55],endFill:"",alpha:.75},null,8,E),I]),(s(!0),i(_,null,p(t(a),l=>(s(),i("Graphics",{x:l*t(n),lineStyle:[1],moveTo:[0,0],lineTo:[0,t(u)*t(n)]},null,8,N))),256)),(s(!0),i(_,null,p(t(u),l=>(s(),i("Graphics",{y:l*t(n),lineStyle:[1],moveTo:[0,0],lineTo:[t(a)*t(n),0]},null,8,H))),256)),d("Text",{text:"🍔",x:f.value[0]*t(n),y:f.value[1]*t(n),style:U({fontSize:t(n)/1.4,lineHeight:t(n)})},null,12,M),(s(!0),i(_,null,p(c.value,l=>(s(),i("Graphics",{x:l[0]*t(n),y:l[1]*t(n),beginFill:[0],drawRect:[0,0,t(n),t(n)],endFill:""},null,8,V))),256)),d("Text",{text:"按空格 暂停/继续",x:t(a)*t(n)*.45,y:t(u)*t(n)*.6,style:{fill:"#cccccc60"}},null,8,$),t(A)?z("",!0):(s(),i("Text",{key:0,text:"暂停中……",x:t(a)*t(n)*.45,y:t(u)*t(n)*.7,style:{fill:"#cccccc60"}},null,8,j))],8,B))}});export{J as default};
