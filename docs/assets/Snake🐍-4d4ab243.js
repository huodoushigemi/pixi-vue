import{b as G}from"./index-91b43c1c.js";import{u as L}from"./index-0a5e881a.js";import{d as C,g as R,i as x,r as b,o as D,c as l,b as h,u as t,F as y,j as _,n as U,k as z,a as s}from"./index-43f8040e.js";const B=["drawRect"],E={zIndex:1},I=["drawRect","alpha"],N=h("Text",{text:"🐍 SNAKE",x:12,"style+":{fill:16777215,lineHeight:55}},null,-1),H=["x","lineTo"],M=["y","lineTo"],V=["x","y"],$=["x","y","drawRect"],j=["x","y"],K=["x","y"],O=C({__name:"Snake🐍",setup(P){const d=R().proxy.$app.screen.width,w=R().proxy.$app.screen.height-80,n=x(()=>Math.min(d,w)/10),a=x(()=>d/n.value>>0),u=x(()=>w/n.value>>0),c=b([[2,5],[1,5],[0,5]]),f=b(k());let o="ArrowRight",g=o;G(window,"keydown",e=>{if(e.key==" ")return v.value?m():F();["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&(o=="ArrowUp"&&e.key=="ArrowDown"||o=="ArrowDown"&&e.key=="ArrowUp"||o=="ArrowLeft"&&e.key=="ArrowRight"||o=="ArrowRight"&&e.key=="ArrowLeft"||(g=e.key))});const{resume:F,pause:m,isActive:v}=L(()=>{o=g;const e=c.value[0];let r;if(o=="ArrowUp"&&(r=[e[0],e[1]-1]),o=="ArrowDown"&&(r=[e[0],e[1]+1]),o=="ArrowLeft"&&(r=[e[0]-1,e[1]]),o=="ArrowRight"&&(r=[e[0]+1,e[1]]),!S(r))return m(),alert("撞墙身亡，游戏结束");if(c.value.slice(0,-1).some(i=>p(i,r)))return m(),alert("咬到自己，游戏结束");c.value.unshift(r),p(r,f.value)?f.value=k():c.value.pop()},250);D(()=>{m()});function T(){const e=document.createElement("a");e.href="https://github.com/huodoushigemi/vue-canvas-snake.git",e.target="_blank",e.click()}function p(e,r){return e[0]==r[0]&&e[1]==r[1]}function S(e){return e[0]>=0&&e[0]<a.value&&e[1]>=0&&e[1]<u.value}function A(e,r=0){return r+Math.random()*(e-r)>>0}function k(){let e;do e=[A(a.value),A(u.value)];while(c.value.some(r=>p(r,e)));return e}return(e,r)=>(s(),l("Graphics",{sortableChildren:!0,beginFill:[2368548],drawRect:[0,0,t(d),w],endFill:""},[h("Graphics",E,[h("Graphics",{beginFill:[2962235],drawRect:[0,0,t(d),55],endFill:"",alpha:.75},null,8,I),N,h("Sprite",{image:"https://huodoushigemi.github.io/docx2vue/assets/github-540f5a2f.svg",x:168,y:5,width:45,height:45,cursor:"pointer",onClick:T})]),(s(!0),l(y,null,_(t(a),i=>(s(),l("Graphics",{x:i*t(n),lineStyle:[1],moveTo:[0,0],lineTo:[0,t(u)*t(n)]},null,8,H))),256)),(s(!0),l(y,null,_(t(u),i=>(s(),l("Graphics",{y:i*t(n),lineStyle:[1],moveTo:[0,0],lineTo:[t(a)*t(n),0]},null,8,M))),256)),h("Text",{text:"🍔",x:f.value[0]*t(n),y:f.value[1]*t(n),style:U({fontSize:t(n)/1.4,lineHeight:t(n)})},null,12,V),(s(!0),l(y,null,_(c.value,i=>(s(),l("Graphics",{x:i[0]*t(n),y:i[1]*t(n),beginFill:[0],drawRect:[0,0,t(n),t(n)],endFill:""},null,8,$))),256)),h("Text",{text:"按空格 暂停/继续",x:t(a)*t(n)*.45,y:t(u)*t(n)*.6,style:{fill:"#cccccc60"}},null,8,j),t(v)?z("",!0):(s(),l("Text",{key:0,text:"暂停中……",x:t(a)*t(n)*.45,y:t(u)*t(n)*.7,style:{fill:"#cccccc60"}},null,8,K))],8,B))}});export{O as default};
